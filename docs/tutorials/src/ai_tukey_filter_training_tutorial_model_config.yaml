# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Configuration for AI Tukey Filter Training Tutorial
# Optimized for demonstration and faster execution

# Debug settings
debug:
  disable_jit: false  # Set to true to disable JIT compilation (slower but easier to debug)

# Output directories (will be updated by tutorial to use generated dataset)
paths:
  output_dir: /opt/nvidia/aerial-framework/out/ai_tukey_filter_tutorial_training
  checkpoint_dir: checkpoints  # Relative to output_dir
  dataset_dir: /opt/nvidia/aerial-framework/out/ai_tukey_filter_tutorial_dataset

# Model architecture
model:
  tau_max: 1024
  compressed_len: 64
  d_model: 64
  n_heads: 4
  n_layers: 2
  input_subsample_factor: 64  # Subsample cumsum_power_norm: 1=no subsample, 32=every 32nd, 64=every 64th
  fft_size: 2048  # FFT size for delay domain processing (must match inference)
  delay_compensation_samples: 0.0  # Delay compensation in samples (must match inference)

# Training hyperparameters (adjusted for tutorial - faster but still effective)
training:
  learning_rate: 5.0e-5
  batch_size: 32
  num_epochs: 4
  warmup_epochs: 1 
  gradient_clip: 5.0
  seed: 42
  snr_min_db: -21.0  # Minimum SNR for training (dB)
  snr_max_db: 12.0   # Maximum SNR for training (dB)

# Channel parameters (n_prb loaded from dataset_config.yaml)
channel: {}

# DMRS extraction pattern (CDM group 0)
dmrs_extraction:
  stride: 2  # Every 2nd subcarrier
  offset: 0  # Starting at index 0

# DMRS configuration (must match test vector or use defaults)
dmrs_config:
  n_dmrs_id: 0
  slot_number: 0
  n_t: 14  # Number of OFDM symbols
  port_idx: [0]  # DMRS port numbers
  vec_scid: [0]  # Scrambling ID
  dmrs_idx: [2,]  # DMRS symbol indices
  start_prb: 0
  energy: 2.0  # DMRS energy scaling

