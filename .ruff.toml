# Ruff configuration - comprehensive replacement for black, isort, flake8, pylint
# Strict PEP compliance and naming conventions enforced throughout
# https://docs.astral.sh/ruff/

# Exclude a variety of commonly ignored directories.
exclude = [
    ".bzr",
    ".direnv",
    ".eggs",
    ".git",
    ".git-rewrite",
    ".hg",
    ".ipynb_checkpoints",
    ".mypy_cache",
    ".nox",
    ".pants.d",
    ".pyenv",
    ".pytest_cache",
    ".pytype",
    ".ruff_cache",
    ".svn",
    ".tox",
    ".venv",
    ".vscode",
    "__pypackages__",
    "_build",
    "buck-out",
    "build",
    "dist",
    "node_modules",
    "site-packages",
    "venv",
]

# Same as Black's default
line-length = 100
indent-width = 4

# Assume Python 3.12
target-version = "py312"

[lint]
# Enable comprehensive rule sets for maximum code quality
select = [
    # Pyflakes (F) - basic error detection
    "F",
    # pycodestyle (E, W) - PEP 8 style guide enforcement
    "E", "W",
    # pep8-naming (N) - PEP 8 naming conventions
    "N",
    # isort (I) - import sorting
    "I",
    # pydocstyle (D) - docstring conventions
    "D",
    # pyupgrade (UP) - upgrade syntax for newer Python versions
    "UP",
    # flake8-annotations (ANN) - type annotations
    "ANN",
    # flake8-async (ASYNC) - async/await usage
    "ASYNC",
    # flake8-bugbear (B) - find likely bugs and design problems
    "B",
    # flake8-simplify (SIM) - simplify code
    "SIM",
    # flake8-comprehensions (C4) - unnecessary complexity in comprehensions
    "C4",
    # flake8-pie (PIE) - miscellaneous improvements
    "PIE",
    # flake8-unused-arguments (ARG) - unused function arguments
    "ARG",
    # flake8-use-pathlib (PTH) - use pathlib instead of os.path
    "PTH",
    # flake8-errmsg (EM) - format error messages
    "EM",
    # flake8-implicit-str-concat (ISC) - implicit string concatenation
    "ISC",
    # flake8-print (T20) - print statement checker
    "T20",
    # flake8-pytest-style (PT) - pytest-specific style
    "PT",
    # flake8-return (RET) - return statement checker
    "RET",
    # flake8-self (SLF) - private member access
    "SLF",
    # flake8-slots (SLOT) - require __slots__
    "SLOT",
    # flake8-type-checking (TCH) - type-checking imports
    "TCH",
    # tryceratops (TRY) - exception handling
    "TRY",
    # perflint (PERF) - performance anti-patterns
    "PERF",
    # Ruff-specific rules (RUF)
    "RUF",
    # NumPy-specific rules (NPY)
    "NPY",
    # Pandas-specific rules (PD)
    "PD",
    # Pylint convention (PLC), error (PLE), refactor (PLR), warning (PLW)
    "PLC", "PLE", "PLR", "PLW",
    # flake8-commas (COM) - trailing commas
    "COM",
    # flake8-quotes (Q) - quote style consistency
    "Q",
    # flake8-logging-format (LOG) - logging format
    "LOG",
    # flake8-bandit (S) - security issues
    "S",
    # flake8-boolean-trap (FBT) - boolean trap
    "FBT",
    # flake8-raise (RSE) - raise statement
    "RSE",
    # flake8-tidy-imports (TID) - tidy imports
    "TID",
    # flake8-gettext (INT) - gettext
    "INT",
    # flake8-executable (EXE) - executable
    "EXE",
    # flake8-no-pep420 (INP) - missing __init__.py
    "INP",
    # flake8-logging (G) - logging issues
    "G",
    # flake8-datetimez (DTZ) - datetime usage
    "DTZ",
    # flake8-django (DJ) - Django-specific rules
    "DJ",
    # flake8-debugger (T10) - debugger imports
    "T10",
    # flake8-fixme (FIX) - TODO/FIXME comments
    "FIX",
    # flake8-todos (TD) - TODO comments
    "TD",
    # eradicate (ERA) - commented-out code
    "ERA",
    # flake8-2020 (YTT) - sys.version_info usage
    "YTT",
    # flake8-blind-except (BLE) - blind except statements
    "BLE",
    # flake8-builtins (A) - shadowing of Python builtins
    "A",
    # flake8-future-annotations (FA) - future annotations
    "FA",
]

ignore = [
    # TODO/FIXME rules (uncomment if you want to allow them)
    # "FIX002", # Line contains TODO, consider resolving the issue
    # "TD002",  # Missing author in TODO
    # "TD003",  # Missing issue link on the line following this TODO

    # Rules that may conflict with common patterns
    "COM812", # Missing trailing comma (conflicts with formatter)
    "ISC001", # Implicitly concatenated string literals (conflicts with formatter)

    # Exception handling that may be too strict for some cases
    "TRY003", # Avoid specifying long messages outside the exception class

    # Logging and exception formatting - allow f-strings for readability
    "G004",   # Logging statement uses f-string
    "EM102",  # Exception must not use an f-string literal, assign to variable first
]

[lint.per-file-ignores]
# Only minimal exceptions for specific file types
"**/src/**/__init__.py" = [
    "TID252" # Allow relative imports in __init__.py
]
"**/tests/**/__init__.py" = [
    "TID252" # Allow relative imports in __init__.py
]

# Test files can use more relaxed rules
"**/tests/**/*.py" = [
    "S101",     # Use of assert
    "T201",     # print found
    "TID252",   # prefer absolute over relative imports
    "PT011",    # pytest.raises without match parameter
    "PT012",    # pytest.raises should contain a single statement
]

# Allow fix for all enabled rules (when `--fix`) is provided.
fixable = ["ALL"]
unfixable = []

[lint.pydocstyle]
# Use NumPy docstring convention for consistency
convention = "numpy"

[lint.mccabe]
# Complexity threshold (matching flake8 configuration)
max-complexity = 10

[lint.isort]
# Configure import sorting (replaces isort)
known-first-party = ["ran"]
force-single-line = false
force-sort-within-sections = false
single-line-exclusions = []
combine-as-imports = true
split-on-trailing-comma = true

[lint.flake8-quotes]
# Use double quotes to match formatter
inline-quotes = "double"
multiline-quotes = "double"
docstring-quotes = "double"

[lint.pylint]
# Configure pylint-style rules
max-args = 8
max-branches = 12
max-returns = 6
max-statements = 50

[lint.flake8-annotations]
# Type annotation configuration
allow-star-arg-any = false
ignore-fully-untyped = false
suppress-dummy-args = true

[lint.flake8-bugbear]
# Extend immutable calls to include additional functions
extend-immutable-calls = ["fastapi.Depends", "fastapi.Security"]

[lint.flake8-pytest-style]
# Configure pytest style rules
fixture-parentheses = false
mark-parentheses = false
parametrize-names-type = "tuple"
parametrize-values-type = "tuple"
parametrize-values-row-type = "tuple"

[lint.flake8-tidy-imports]
# Ban certain imports
ban-relative-imports = "all"

[lint.flake8-type-checking]
# Type checking configuration
strict = true
exempt-modules = ["typing"]

[lint.flake8-unused-arguments]
# Unused arguments configuration
ignore-variadic-names = true

[format]
# Like Black, use double quotes for strings.
quote-style = "double"

# Like Black, indent with spaces, rather than tabs.
indent-style = "space"

# Like Black, respect magic trailing commas.
skip-magic-trailing-comma = false

# Like Black, automatically detect the appropriate line ending.
line-ending = "auto"

# Enable auto-formatting of docstrings
docstring-code-format = true

# Format code snippets in docstrings
docstring-code-line-length = 80

# Enable preview features for cutting-edge formatting
preview = false
